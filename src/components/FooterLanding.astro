---
// Components
import Button from "components/Button.astro"
import Logo from "./Logo.astro"

// i18n utilities
import { getCurrentLocale, createTranslationFunction, loadTranslations, getLocalizedPath } from "../i18n/utils";

// Load translations
await loadTranslations();

// Get current locale and translation function
const currentLocale = getCurrentLocale(Astro);
const t = createTranslationFunction(currentLocale);

// Define navigation links with translation keys
const navigationConfig = {
  en: [
    {
      text: "Speakers",
      link: "/speakers",
    },
    {
      text: "Tracks",
      link: "/#tracks",
    },
    {
      text: "Spotlight",
      link: "/#spotlight",
    },
    {
      text: "Co-located Events",
      link: "/#co-located-events",
    },
    {
      text: "Venue",
      link: "/venue",
    },
  ],
  zh: [
    {
      text: "讲师",
      link: "/speakers",
    },
    {
      text: "主题",
      link: "/#tracks",
    },
    {
      text: "Spotlight",
      link: "/#spotlight",
    },
    {
      text: "同期活动",
      link: "/#co-located-events",
    },
    {
      text: "会议地点",
      link: "/venue",
    },
  ]
};

// Get localized navigation links
const firstColumnLinks = navigationConfig[currentLocale].map(link => ({
  ...link,
  link: (link.link && link.link.startsWith('#')) ? link.link : getLocalizedPath(link.link || '/', currentLocale)
}));

const secondColumnLinks = [
  // Future volunteer links can be added here
];

const slug = Astro.url.pathname
---

<footer class="section footer" data-theme-section="dark" data-bg-section="dark">
  <div class="container">
    <div class="row row-base">
      <div class="col col-logo-gosim">
        <div class="logo">
          <a href={getLocalizedPath('/', currentLocale)} aria-label={t('navigation.go_to_homepage')} class="logo-click">
            <Logo />
          </a>
        </div>
      </div>

      <nav class="col col-sitemap" aria-label="Navigation Footer">
        <ul>
          {
            firstColumnLinks.map((loop: any) => (
              <li
                class="link link-hover"
                data-barba-update
                data-link-status={loop.link === slug ? "active" : "not-active"}
              >
                <a
                  class="link-click"
                  href={loop.link}
                  target={loop?.openInNewTab ? "_blank" : "_self"}
                  rel={loop?.openInNewTab ? "noopener noreferrer" : ""}
                >
                  <span>{loop.text}</span>
                </a>
              </li>
            ))
          }
        </ul>

        <ul>
          {
            secondColumnLinks.map((loop: any) => (
              <li
                class="link link-hover"
                data-barba-update
                data-link-status={loop.link === slug ? "active" : "not-active"}
              >
                {loop.subLinks ? (
                  <div style="margin-top: 2.25rem;">
                    <span style="color: #fff; font-size: 1rem;">
                      {loop.text}
                    </span>
                    <ul style="margin-top: 0.75rem;">
                      {loop.subLinks.map((subLink: any) => (
                        <li class="link link-hover">
                          <a
                            class="link-click"
                            href={subLink.link}
                            target={subLink?.openInNewTab ? "_blank" : "_self"}
                            rel={
                              subLink?.openInNewTab ? "noopener noreferrer" : ""
                            }
                          >
                            <span>{subLink.text}</span>
                          </a>
                        </li>
                      ))}
                    </ul>
                  </div>
                ) : (
                  <a
                    class="link-click"
                    href={loop.link}
                    target={loop?.openInNewTab ? "_blank" : "_self"}
                    rel={loop?.openInNewTab ? "noopener noreferrer" : ""}
                  >
                    <span>{loop.text}</span>
                  </a>
                )}
              </li>
            ))
          }
        </ul>
      </nav>

      <!-- <div class="col col-newsletter">
        <div class="col-row col-row-title">
          <h2 class="h4">Stay up to date on all things GOSIM 2025</h2>
        </div>
        <div class="col-row col-row-input">
          <Button
            link="#"
            text="Join our newsletter"
            class="btn primary xl btn-hover"
          />
        </div>
        <div class="col-row col-row-text styled-content">
          <p>
            Subscribe to the GOSIM Foundation mailing list to stay in the know.
          </p>
        </div>
      </div> -->
    </div>

    <div class="row row-end">
      <div class="col col-logo-gosim2">
        <div class="logo">
          <a
            href="https://gosim.org"
            target="_blank"
            class="logo-click"
            aria-label={t('footer.gosim_foundation')}
          >
            <Logo width="141" height="24" />
          </a>
        </div>
        <div class="row footer-socials">
          <a
            href="https://mastodon.social/@gosim"
            target="_blank"
            rel="noopener noreferrer"
          >
            <img
              src="/icons/icon-mastodon.svg"
              alt={t('footer.follow_mastodon')}
              width="18"
              height="18"
              loading="lazy"
              style="filter: invert(1);"
            />
          </a>
          <a
            href="https://x.com/gosimfoundation"
            target="_blank"
            rel="noopener noreferrer"
          >
            <img
              src="/icons/icon-x.svg"
              alt={t('footer.follow_x')}
              width="18"
              height="18"
              loading="lazy"
              style="filter: invert(1);"
            />
          </a>
          <a
            href="https://www.linkedin.com/company/gosim-foundation"
            target="_blank"
            rel="noopener noreferrer"
          >
            <img
              src="/icons/icon-linkedin.svg"
              alt={t('footer.follow_linkedin')}
              width="18"
              height="18"
              loading="lazy"
              style="filter: invert(1);"
            />
          </a>
          <a
            href="https://bsky.app/profile/gosimfoundation.bsky.social"
            target="_blank"
            rel="noopener noreferrer"
          >
            <img
              src="/icons/icon-bluesky.svg"
              alt={t('footer.follow_bluesky')}
              width="18"
              height="18"
              loading="lazy"
              style="filter: invert(1);"
            />
          </a>
          <a
            href="https://www.youtube.com/@GOSIMFoundation"
            target="_blank"
            rel="noopener noreferrer"
          >
            <img
              src="/icons/icon-youtube.svg"
              alt={t('footer.follow_youtube')}
              width="18"
              height="18"
              loading="lazy"
              style="filter: invert(1);"
            />
          </a>
        </div>
      </div>

      <div class="col col-copyright"></div>

      <div class="col col-dev-credits">
        <div class="link link-hover">
          <a class="link-click" href={getLocalizedPath('/code-of-conduct/', currentLocale)}>
            <span>{t('footer.code_of_conduct')}</span>
          </a>
        </div>
        <div class="link link-hover">
          <a class="link-click" href={getLocalizedPath('/privacy/', currentLocale)}>
            <span>{t('footer.privacy')}</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</footer>
